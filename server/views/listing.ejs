<!-- page to display listing information and calendar for rentals -->

<!DOCTYPE html>

<html>

	<head>
		<title>w3bbi</title>
		<%- include("templates/head_links"); %>
		<link rel="stylesheet" href="/css/fullcalendar.min.css" type="text/css" />
		<link rel="stylesheet" href="/css/listing.css" type="text/css" />
		<script src="https://checkout.stripe.com/checkout.js"></script>
		<script src="/js/moment/moment.min.js" type="text/javascript"></script>
		<script src="/js/fullcalendar.min.js" type="text/javascript"></script>
		<script src="/js/cookie.js" type="text/javascript"></script>
		<script src="/js/routes/client_listing.js" type="text/javascript"></script>
		<script src="/js/routes/client_calendar.js" type="text/javascript"></script>
		<script type="text/javascript">
			var user = <% if(typeof user != "undefined"){ %><%-JSON.stringify(user)%><% }else{ %>""<% } %>;
			var message = <% if(typeof message != "undefined"){ %><%-JSON.stringify(message)%><% }else{ %>""<% } %>;
			var listing_info = <% if(typeof listing_info != "undefined"){ %><%-JSON.stringify(listing_info)%><% }else{ %>""<% } %>;
			var new_rental_info = <% if(typeof new_rental_info != "undefined"){ %><%-JSON.stringify(new_rental_info)%><% }else{ %>""<% } %>;
			var rental_info = <% if(typeof rental_info != "undefined"){ %><%-JSON.stringify(rental_info)%><% }else{ %>""<% } %>;
		</script>
	</head>

	<body>
		<%- include("templates/navbar", {user: user}); %>

		<div id="top_wrapper" class="page_wrapper">
			<div id="image_wrapper">
				<img id="background_image" class="background_image noselect" width="100%" height="100%" src="https://source.unsplash.com/category/people">
			</div>
			<div class="info_wrapper">

				<div id="listing_info_wrapper" class="info_wrapper_block">
					<!-- information about the current listing -->
					<div id="listing_info_title">
					<% if (typeof listing_info != "undefined") {%>
						<h2 class="listing_info_text domain_title"><%= listing_info.domain_name %></h2>
						<p id="domain_owner" class="listing_info_text"><%= listing_info.fullname %> | </p>
						<p id="domain_email" class="listing_info_text"><%= listing_info.email %></p>
						</div>
						<p id="domain_description"><%= listing_info.description %></p>
					<% } %>
				</div>

				<div id="price_wrapper" class="info_wrapper_block">
					<div id="price_left_wrapper">
						<p>Hourly</p>
						<p>Daily</p>
						<p>Weekly</p>
						<p>Monthly</p>
					</div>
					<div id="price_right_wrapper">
						<p>$<%=listing_info.hour_price%></p>
						<p>$<%=listing_info.day_price%></p>
						<p>$<%=listing_info.week_price%></p>
						<p>$<%=listing_info.month_price%></p>
					</div>
				</div>

				<div id="start_form_wrapper">
					<input class="button is-primary" id="listing_form_submit" type="submit" value="Rent now!">
				</div>
			</div>

		</div>

		<div id="calendar_wrapper" class="page_wrapper">

			<div id="calendar_top_wrapper">
				<div id="calendar_left_wrapper" class="info_wrapper_block">
					<div class="button" id="prev-button"><</div>
					<div class="button" id="remove_events">Remove events</div>
					<div class="button" id="today-button">Today</div>
					<div class="button" id="next-button">></div>
				</div>

				<div id="calendar_right_wrapper" class="info_wrapper_block">
					<h1 id="price">$0</h1>
					<!-- any messages from the server -->
					<div id="message">
						<% if (typeof message != "undefined") {%>
							<%= message %>
						<% } else {%>
							&nbsp;
						<% } %>
					</div>
				</div>
			</div>

			<div id="calendar"></div>

		</div>

		<div id="ip_wrapper" class="page_wrapper">

			<div class="info_wrapper">
				<h2 class="listing_info_text">Connect <span class="domain_title"><%= listing_info.domain_name %></span> to your website!<h2>
				<input required pattern="^([0-9]{1,3}\.){3}[0-9]{1,3}$" class="input" id="ip_form_input" type="text" placeholder="IP Address">
				<div id="faq_wrapper">
					<h3>Don't know how?</h3>
				</div>
			</div>

		</div>

		<div id="pay_wrapper" class="page_wrapper">

			<div class="info_wrapper">
				<form class="edit_form edit_details_form" id="edit_details_pay" action="/listing/<%=listing_info.domain_name%>/pay" method="post">
					<button class="form_submit button btn btn-primary btn-lg" id="stripe-button">
						Checkout <span class="glyphicon glyphicon-shopping-cart"></span>
					</button>
				</form>
			</div>

		</div>

		<%- include("templates/footer"); %>

	</body>

</html>
