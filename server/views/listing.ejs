<!-- page to display listing information and calendar for rentals -->

<!DOCTYPE html>

<html>

	<head>
		<title>w3bbi</title>
		<%- include("templates/head_links"); %>
		<link rel="stylesheet" href="/css/fullcalendar.min.css" type="text/css" />
		<link rel="stylesheet" href="/css/listing.css" type="text/css" />
		<script src="https://checkout.stripe.com/checkout.js"></script>
		<script src="/js/jquery/jquery-ui.js" type="text/javascript"></script>
		<script src="/js/moment/moment.min.js" type="text/javascript"></script>
		<script src="/js/fullcalendar.min.js" type="text/javascript"></script>
		<script src="/js/cookie.js" type="text/javascript"></script>
		<script type="text/javascript">
			var user = <% if(typeof user != "undefined"){ %><%-JSON.stringify(user)%><% }else{ %>""<% } %>;
			var message = <% if(typeof message != "undefined"){ %><%-JSON.stringify(message)%><% }else{ %>""<% } %>;
			var listing_message = <% if(typeof listing_message != "undefined"){ %><%-JSON.stringify(listing_message)%><% }else{ %>""<% } %>;
			var listing_info = <% if(typeof listing_info != "undefined"){ %><%-JSON.stringify(listing_info)%><% }else{ %>""<% } %>;
			var new_rental_info = <% if(typeof new_rental_info != "undefined"){ %><%-JSON.stringify(new_rental_info)%><% }else{ %>""<% } %>;
			var rental_info = <% if(typeof rental_info != "undefined"){ %><%-JSON.stringify(rental_info)%><% }else{ %>""<% } %>;
		</script>
		<script src="/js/routes/client_calendar.js" type="text/javascript"></script>
		<script src="/js/routes/client_listing.js" type="text/javascript"></script>
	</head>

	<body>
		<%- include("templates/navbar", {user: user}); %>

		<div id="top_wrapper" class="page_wrapper">
			<div id="image_wrapper">
				<img id="background_image" class="background_image noselect" width="100%" height="100%" src="<%= listing_info.background_image || 'https://source.unsplash.com/category/people' %>">
			</div>
			<div class="info_wrapper">

				<div id="listing_info_wrapper">
					<!-- information about the current listing -->
					<div id="listing_info_title" class="listing_info_center">
						<h2 class="listing_info_text green_text"><%= listing_info.domain_name %></h2>
						<p id="domain_owner" class="listing_info_text listing_info_text_white">Owned by: <a class="green_text" href="mailto:<%= listing_info.email %>"><%= listing_info.fullname %></a></p>
						<div id="pricing_wrapper">
							<p class="listing_info_text listing_info_text_white">Hour <span class="green_text">$<%=listing_info.hour_price%></span> | </p>
							<p class="listing_info_text listing_info_text_white">Day <span class="green_text">$<%=listing_info.day_price%></span> | </p>
							<p class="listing_info_text listing_info_text_white">Week <span class="green_text">$<%=listing_info.week_price%></span> | </p>
							<p class="listing_info_text listing_info_text_white">Month <span class="green_text">$<%=listing_info.month_price%></span></p>
						</div>
					</div>

					<% if (rental_info && typeof rental_info != undefined) { %>
						<div id="domain_description" class="rental_hide">
							<div id="rental_times">Rented from:</div>
						</div>
					<% } else {%>
						<p id="domain_description" class="default_hide"><%= listing_info.description %></p>
					<% } %>

					<% if (listing_info.buy_link != null && listing_info.buy_link.length > 0) { %>
						<p id="buy_link" class="listing_info_margin_top listing_info_center"><a class="orange_link" href="<%= listing_info.buy_link %>">Interested in buying this domain?</a></p>
					<% } %>
				</div>

				<div id="start_form_wrapper" class="listing_info_margin_top">
					<% if (rental_info && typeof rental_info != undefined) { %>
						<div class="button next_button rental_hide" id="top_next_rental">Add times</div>
						<div class="button next_button rental_hide" id="calendar_next_rental">Edit website</div>
					<% } else {%>
						<div class="button is-primary next_button default_hide" id="top_next">Get started</div>
					<% } %>
				</div>

			</div>

		</div>

		<div id="calendar_wrapper" class="page_wrapper">

			<div id="calendar_top_wrapper">
				<div id="calendar_price_wrapper">
					<p class="listing_info_text">Hour <span class="green_text">$<%=listing_info.hour_price%></span> | </p>
					<p class="listing_info_text">Day <span class="green_text">$<%=listing_info.day_price%></span> | </p>
					<p class="listing_info_text">Week <span class="green_text">$<%=listing_info.week_price%></span> | </p>
					<p class="listing_info_text">Month <span class="green_text">$<%=listing_info.month_price%></span></p>
				</div>

				<div id="calendar_left_wrapper" class="info_wrapper_block">
					<div class="button" id="remove_events">Remove all</div>
					<div class="button" id="month_button">Month</div>
					<div class="button" id="prev-button"><</div>
					<div class="button" id="today-button">Today</div>
					<div class="button" id="next-button">></div>
				</div>

				<div id="calendar_right_wrapper" class="info_wrapper_block">
					<h1 id="price">$0</h1>
					<div class="button next_button" id="calendar_next">Next</div>
				</div>
			</div>

			<!-- any messages from the server
			<div id="listing_message">
				<% if (typeof listing_message != "undefined") {%>
					<%= listing_message %>
				<% } else {%>
					&nbsp;
				<% } %>
			</div>-->

			<div id="calendar"></div>

		</div>

		<div id="ip_wrapper" class="page_wrapper">

			<div class="info_wrapper">
				<h2 class="listing_info_text listing_info_text_white">Connect <span class="green_text"><%= listing_info.domain_name %></span> to your website!<h2>
				<input required pattern="^([0-9]{1,3}\.){3}[0-9]{1,3}$" class="input" id="ip_form_input" type="text" placeholder="IP Address">
				<div class="button next_button" id="ip_next">Next</div>
				<div id="faq_wrapper">
					<h3>Don't know how?</h3>
				</div>
			</div>

		</div>

		<div id="pay_wrapper" class="page_wrapper">

			<div class="info_wrapper">
				<form id="listing_form" action="/listing/<%=listing_info.domain_name%>/pay" method="post">
					<button class="form_submit button btn btn-primary btn-lg" id="stripe-button">
						Checkout <span class="glyphicon glyphicon-shopping-cart"></span>
					</button>
				</form>
			</div>

		</div>

		<%- include("templates/footer"); %>

	</body>

</html>
