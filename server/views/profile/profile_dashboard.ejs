<!DOCTYPE html>

<html>

	<head>
		<title>Profile Dashboard - DomaHub</title>
		<%- include("../templates/head_links"); %>
		<link rel="stylesheet" href="/css/profile.css" type="text/css" />
	</head>

<body>

	<%- include("../templates/navbar", {user: user}); %>

	<section class='min-height'>

	<div class="container clear-nav-profile">
		<div class="tabs is-centered">
		  <ul>
		    <li class="is-active"><a href="/profile/dashboard" tabindex="7" title="Dashboard">Dashboard</a></li>
		    <li><a href="/profile/inbox" tabindex="8" title="Inbox">Inbox</a></li>
		    <li><a href="/profile/mylistings" tabindex="9" title="Listings">Listings</a></li>
		    <li><a href="/profile/myrentals" tabindex="10" title="Rentals">Rentals</a></li>
		    <li><a href="/profile/settings" tabindex="11" title="Settings">Settings</a></li>
		  </ul>
		</div>
	</div>

	<section class="section">
		<div class="container">
			<div class="columns">

				<div class="column is-one-quarter">
					<div class="card no-shadow margin-bottom-25">
						<div class="card-image">
							<figure class="image is-4by3">
								<img src="https://placeholdit.imgix.net/~text?txtsize=30&bg=9e9e9e&txtclr=ffffff&txt=<%= user.username %>&w=300&h=200" />
							</figure>
							<p class="card-footer-item">
				              <input type="file" name="csv" id="profile_pic" class="input-file" />
				              <label id="profile_pic-label" for="profile_pic" class="button"><i class="fa fa-upload"></i><span class="label-text">Upload Picture</span></label>
				            </p>
						</div>
						<div class="card-content">
							<h2 class="has-text-centered"><%= user.username %></h2>
							<h3 class="has-text-centered"><%= user.email %></h3>
						</div>

						<footer class="card-footer">
							<a class="card-footer-item button is-outlined is-accent" href="/profile/settings">Edit Profile</a>
						</footer>
					</div>
					<article class="message no-shadow margin-bottom-25">
						<div class="message-header is-primary has-text-centered">
							Quick Links
						</div>
						<div class="message-body has-text-centered">
							<div class="content">
								<ul>
									<li><a class="black-link" href="/authorizestripe" title="Payments">Manage Payments</a></li>
									<li><a class="black-link" href="/profile/settings" title="Change Email">Change Email Address</a></li>
									<li><a class="black-link" href="/faq" title="FAQ">Frequently Asked Questions</a></li>
								</ul>
							</div>
						</div>
					</article>
				</div>

				<div class="column">
					<box class="box no-shadow">
						<table id="domain_table" class="table">
							<caption class="caption">
								My Listings View Count
							</caption>
						</table>

						<canvas id="myChart"></canvas>

						<a class="button is-accent" href="/listings/create" title="Create a new listing">Create a new listing</a>
					</box>
					<div class="box no-shadow">
						<table class="table">
							<caption class="caption">
								My Rentals
							</caption>
							<thead>
								<tr>
									<th>Domain Name</th>
									<th>Status</th>
								</tr>
							</thead>
							<tbody id="rental_table"></tbody>
						</table>

						<a class="button is-accent" href="/listings" title="Browse domain names">Browse domain names</a>
					</div>
				</div>

				<% if (user.type != 2){ %>
					<div class="column is-one-quarter">
						<article class="message">
							<div class="message-body has-text-centered">
								<div class="content">
									<p>
										You must connect your account with <a href="https://stripe.com/about">Stripe</a> before you can receive payments.
									</p>
									<a href="/authorizestripe" class="button is-success">Connect with Stripe</a>
								</div>
							</div>
						</article>
					</div>
				<% } %>

			</div>
		</div>

	</section>

	</section>

	<%- include("../templates/footer"); %>
	<%- include("../templates/js_scripts"); %>
	<script src="/js/lib/moment.min.js" type="text/javascript"></script>
	<script src="/js/lib/randomColor.js" type="text/javascript"></script>
	<script src="/js/lib/chart.min.js" type="text/javascript"></script>
	<script type="text/javascript">
		//redirect to homepage if user is not defined
		var user = <% if(typeof user != "undefined"){ %><%-JSON.stringify(user)%><% }else{ %>window.location="/"<% } %>;
		var listings_search = <% if(typeof listings_search != "undefined"){ %><%-JSON.stringify(listings_search)%><% }else{ %>""<% } %>;
		var rentals = <% if(typeof rentals != "undefined"){ %><%-JSON.stringify(rentals)%><% }else{ %>""<% } %>;
	</script>
	<script src="/js/routes/profile/profile_dashboard_logic.js" type="text/javascript"></script>

	</body>

</html>
