<!-- user profile page, should not see unless logged in -->

<!DOCTYPE html>

<html>

	<head>
		<title>w3bbi</title>
		<link rel="stylesheet" href="/css/style_base.css" type="text/css" />
		<link rel="stylesheet" href="/css/profile.css" type="text/css" />
		<!--<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script> -->
		<script src="/js/jquery/jquery.js" type="text/javascript"></script>
		<script src="/js/moment/moment.min.js" type="text/javascript"></script>
		<script type="text/javascript">
			//redirect to homepage if user is not defined
			var user = <% if(typeof user != "undefined"){ %><%-JSON.stringify(user)%><% }else{ %>window.location="/"<% } %>;
			var listings = <% if(typeof listings != "undefined"){ %><%-JSON.stringify(listings)%><% }else{ %>""<% } %>;
			var rentals = <% if(typeof rentals != "undefined"){ %><%-JSON.stringify(rentals)%><% }else{ %>""<% } %>;
		</script>
		<script src="/js/routes/client_profile.js" type="text/javascript"></script>
		<link rel="icon" type="image/ico" href="/images/favicon.ico">
	</head>

	<body>

		<% if (typeof user != "undefined") {%>
			<p>Logged in: <%= user.email %></p>
			<p><a href="/">Home</a></p>
			<p><a href="/logout">Log Out</a></p>

			<p id="message">Welcome!</p>

			<h2>My Domains:</h2>

			<p><a href="/listing/create">Create a new listing</a></p>

			<% if (typeof listings != "undefined") {%>
				<table id="domain_table">
					<th>Domain Name</th>
					<th>Active?</th>
					 <% listings.forEach(function (listing) { %>
						<tr>
							<td><a href="/listing/<%= listing.domain_name %>"><%= listing.domain_name %></a></td>
							<td><%= (listing.price_type != 0) ? "True" : "False"%></td>
							<% if (listing.price_type == 0){ %>
								<td class="activate_button" id="activate_<%= listing.domain_name %>">Activate?</td>
							<% } %>
						</tr>
					 <% }) %>
				</table>
			<% } else { %>
				<p>You have no domains currently!</p>
			<% } %>


			<h2>My Rentals:</h2>
			<% if (typeof rentals != "undefined") {%>
				<table id="rental_table">
					<th>Domain Name</th>
					<th>Start Date</th>
					<th>End Date</th>
				</table>
			<% } else { %>
				<p>You have no rentals currently!</p>
			<% } %>

		<% } else {%>
			<%- include("login"); %>
		<% } %>
	</body>

</html>
